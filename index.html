<!-- The latest version of Tecton can be found at tecton.q2developer.com -->
<script src="https://cdn1.onlineaccess1.com/cdn/base/tecton/v1.57.0/q2-tecton-sdk.js"></script>
<script>
    console.log('#### Before DOMContentLoaded')
    let clickCount = 0
    function resizeContainer() {
        clickCount++
        document.querySelector('.container').style.height = `${500 * clickCount}px`
        document.querySelector('.container').textContent = `${500 * clickCount}px`
    }
    window.addEventListener('DOMContentLoaded', function() {
        document.querySelector('button').addEventListener('click',  resizeContainer);
        console.log('#### DOMContentLoaded window.location.search -', window.location.search)
        //var moduleIdParam = 'tct-id=tectonRoute.AJSSR10.Main';
        var moduleIdParam = 'tct-id=tectonRoute.AJSSR11.Main';
        var urlWithModuleId;
        if (window.location.search) {
            if (window.location.search.indexOf('tct-id') === -1) {
                console.log('#### moduleIdParam 1- ', moduleIdParam)
                urlWithModuleId = window.location.href + '&' + moduleIdParam;
            }
            console.log('#### moduleIdParam 2 - ', moduleIdParam)
        } else {
            urlWithModuleId = window.location.href + '?' + moduleIdParam
            console.log('#### urlWithModuleId - ', urlWithModuleId)
        }
        urlWithModuleId && window.history.pushState({path:urlWithModuleId},'',urlWithModuleId);
        console.log('#### pushState - ', urlWithModuleId, Tecton, Tecton.connect)

        window.tecton = { };
        window.tecton.connected = Tecton.connect().then(function(capabilities) {
            console.log('#### window.tecton.connected ', capabilities)
            window.tecton.actions = capabilities.actions;
            window.tecton.sources = capabilities.sources;
            // this will turn off the spinner and show the iframe.
            // if you want to defer this then remove this line but call it somewhere else.
            capabilities.actions.setFetching(false);
            capabilities.actions.resizeIframe();            
            capabilities.sources.platformScrollChanged(function(scrollInfo) {
                console.log('#### scrollInfo-', scrollInfo)
            })            

            setTimeout(() => {
                document.querySelector('.container').style.height = '1500px';
                capabilities.actions.resizeIframe();
                console.log('#### resizeIframe')
            },  5000)
        }).catch(e => console.log('#### connected error', e));;
        
    })
</script>
<style>
    .container {
        background: hotpink;
        height: 1200px;
    }
</style>
<body>
    <div>
        <button>Increase size</button>
    </div>
    <div class="container">
        
    </div>
</body>
